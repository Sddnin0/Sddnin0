using UnityEngine;
using UnityEngine.UI;
using System.Collections;

public class ToggleUI : MonoBehaviour
{
    public GameObject targetPanel;       // The panel to toggle
    public CanvasGroup canvasGroup;      // CanvasGroup for fade effect
    public Button toggleButton;          // The button to toggle

    private bool isVisible = true;

    void Start()
    {
        // Assign the button click event
        toggleButton.onClick.AddListener(TogglePanel);

        // Set purple color to the button
        Color purpleColor = new Color(0.5f, 0f, 0.5f, 1f); // RGBA
        toggleButton.GetComponent<Image>().color = purpleColor;

        // Ensure panel is visible at start
        canvasGroup.alpha = 1f;
        targetPanel.SetActive(true);
    }

    void TogglePanel()
    {
        isVisible = !isVisible;
        StopAllCoroutines(); // Stop any running fades
        StartCoroutine(FadeCanvas(isVisible));
    }

    IEnumerator FadeCanvas(bool show)
    {
        float startAlpha = canvasGroup.alpha;
        float endAlpha = show ? 1f : 0f;
        float duration = 0.3f;
        float time = 0f;

        if (show) targetPanel.SetActive(true);

        while (time < duration)
        {
            time += Time.deltaTime;
            float t = time / duration;
            canvasGroup.alpha = Mathf.Lerp(startAlpha, endAlpha, t);
            yield return null;
        }

        canvasGroup.alpha = endAlpha;

        if (!show) targetPanel.SetActive(false);
    }
}
